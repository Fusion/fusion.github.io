
<!DOCTYPE html>
<html lang="en-us">

<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta property="og:title" content=" Creating a ReasonML Native App: Command Line Arguments &middot;  The Nexus" />
    <meta property="og:site_name" content="The Nexus" />
    <meta property="og:url" content="http://zteo.com/posts/reason-native-app-part-4/" />

    
    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content="2018-09-08T13:33:01-04:00" />
    <meta property="og:article:tag" content="reason" />
    <meta property="og:article:tag" content="functional" />
    

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta name="twitter:title" content="Creating a ReasonML Native App: Command Line Arguments" />
    
    <meta name="twitter:description" content="Before going into how specific features were implemented with Reason and OCaml&rsquo;s help, let&rsquo;s have a quick look at our application&rsquo;s logic" />
    <meta name="twitter:url" content="http://zteo.com/posts/reason-native-app-part-4/" />
    

    <title> Creating a ReasonML Native App: Command Line Arguments &middot;  The Nexus</title>

    <link rel="preload" href="http://zteo.com//css/fontawesome-all.min.css" as="style" />
    <link rel="preload" href="http://zteo.com//js/main.js" as="script" />
    <link rel="preload" href="http://zteo.com//css/main.css" as="style" />
    
    <link href="/mermaid/mermaid.cfr.css?1604042317" type="text/css" rel="stylesheet" />
    
    
    <link rel="preload" href="http://zteo.com//css/cfr.css" as="style" />
    <link rel="stylesheet" href="http://zteo.com//css/main.css">
    <link rel="stylesheet" href="http://zteo.com//css/pure-min.css">
    <link rel="preload" href="http://zteo.com//js/basicLightbox.min.js" as="script" />
    <link rel="stylesheet" href="http://zteo.com//css/basicLightbox.min.css">
    <link rel="stylesheet" href="http://zteo.com//css/fontawesome-all.min.css" />
    <link rel="stylesheet" href="http://zteo.com//css/cfr.css">
    <link rel="stylesheet" href="http://zteo.com//css/syntax.css">
    
    
    


    
    <meta name="description" content="" />
    

    
    <meta name="p:domain_verify" content=""/>
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    

    
    <link href="http://zteo.com/index.xml" rel="alternate" type="application/rss+xml" title="The Nexus" />
    

    
    <link rel="canonical" href="http://zteo.com/posts/reason-native-app-part-4/" />

    
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "http:\/\/zteo.com\/posts\/reason-native-app-part-4\/"
        },
        "headline": "Creating a ReasonML Native App: Command Line Arguments",
        "description": "",
        "author": {
            "@type": "Person",
            "name": " ",
            "url": "http://profiles.google.com/?rel=author",
            "image": {
              "@type": "ImageObject",
              "url": "https:",
              "height": 80,
              "width": 80
            }
        },
        "publisher": {
          "@type": "Organization",
          "@id": "http:\/\/zteo.com\/",
          "name": "The Nexus",
          "url": "http:\/\/zteo.com\/",
          "logo": {
            "@type": "ImageObject",
            "url": "https:",
            "height": 80,
            "width": 80
          }
        },
        
        "image": {
          "@type": "ImageObject",
          "url": "",
          "height": 80,
          "width": 80
        },
        "datePublished": "2018-09-08",
        "dateModified": "2018-09-08",
        "wordCount":  878 ,
        "keywords": "[\"reason\",\"functional\"]" 
    }
    </script>
    

    
    <script type="text/javascript">
        
        
    </script>
    

    <script type="text/javascript">
        var config = {
            baseUrl: "http:\/\/zteo.com\/"
        };
    </script>

</head>
<body class="home-template">
<div id="loader-wrapper">
    <div id="loader"></div>
</div>
<section id="wrapper" style="display: none;">
    <div id="ajax-container">
        <nav id="nav" class="nav">
            <div class="nav-logo">
                <a href="http://zteo.com/">
                    
                    The Nexus
                    
                </a>
            </div>

            <nav id="nav2" role="navigation">
                <a href="#nav" title="Show navigation">Show navigation</a>
                <a href="#" title="Hide navigation">Hide navigation</a>
                <ul class="clearfix">
                    <li><a href="http://zteo.com/">BLOG</a></li>
                    <li>
                        <a href="http://zteo.com/meta/about" aria-haspopup="true"><span>ABOUT</span></a>
                        <ul>
                            <li><a href="http://zteo.com/meta/egosurfing">Ego Surfing</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="http://zteo.com/projects/projects-list" aria-haspopup="true"><span>PROJECTS</span></a>
                        <ul>
                            <li><a href="http://zteo.com/projects/n2">n2</a></li>
                            <li><a href="http://zteo.com/projects/s2ajax">S2ajax</a></li>
                            <li><a href="http://zteo.com/projects/condo">Condo</a></li>
                            <li><a href="http://zteo.com/projects/ezedit">ezEdit</a></li>
                            <li><a href="http://zteo.com/projects/freeblog">FreeBlog - Air</a></li>
                            <li><a href="http://zteo.com/projects/tooredo-alpha">Tooredo Alpha</a></li>
                            <li><a href="http://zteo.com/projects/tools">Tools</a></li>
                            <li><a href="http://zteo.com/projects/journler-again">Journlr, Again!</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>


            <div id="main-menu" class="nav-menu">
                
                
                <a id="search-button" onclick="$('#search-form').toggle();" title="Search"><i class="fa fa-search"></i></a>
                <form id="search-form" method="get" role="search" action="https://google.com/search">
                    <input type="hidden" name="as_sitesearch" value="http://zteo.com/">
                    <input type="text" name="q" maxlength="255" placeholder="Search..." class="form-control">
                    <input type="submit" value="Search">
                </form>
                
                
                
                
            </div>
        </nav>


<style>
@media(min-width:1024px) {
	main {
		display: grid;
		grid-template-columns: 100% 100%;
	}
}

</style>

<main class="content" role="main">
    <article class="post post-with-bg">
        <div class="inner">

            <div id="push">

                <header class="post-header">
                
                    <span class="post-meta">
                        <span class="post-date">8 Sep 2018</span> <span class="reading-time">| <span class="estimated-reading-time">5 min.</span> (<span class="word-count">878</span> words)</span></span>
                    </span>
                <div class="clear"></div>
                
                <h1 class="post-title">Creating a ReasonML Native App: Command Line Arguments</h1>
              </header>

              <section class="post-content">
                

                
                
                
                    <div class="noticesc">
                    This post is part of a series. Related posts:
                    <ul>
                    
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                            
                                <li><a href="http://zteo.com/posts/reason-native-app/">Creating a ReasonML Native App: What We Are Building</a></li>
                            
                        
                    
                        
                        
                            
                                <li><a href="http://zteo.com/posts/reason-native-app-part-2/">Creating a ReasonML Native App: Installing, Editing, Configuring</a></li>
                            
                        
                    
                        
                        
                            
                                <li><a href="http://zteo.com/posts/reason-native-app-part-3/">Creating a ReasonML Native App: Building and Running</a></li>
                            
                        
                    
                        
                        
                    
                        
                        
                            
                                <li><a href="http://zteo.com/posts/reason-native-app-part-5/">Creating a ReasonML Native App: Configuration Files</a></li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Curses Terminal Interface</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Python Plugins</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Files I/Os</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Native Promises</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Web Requests</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Shell Commands</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Handling CSV Files</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Native JSON Handling</li>
                            
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Memoizing DNS queries</li>
                            
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                    </ul>
                    </div>
                


                
                    <main>
                        <div class="content blog-content">
                        <p>Before going into how specific features were implemented with Reason and OCaml&rsquo;s help, let&rsquo;s have a quick look at our application&rsquo;s logic</p>
<p>(Refresh if the diagram below doesn&rsquo;t display properly)</p>
<div class="mermaid" align="center">
graph TB;
    main --> |play scenario| run
    main --> |edit scenario| editor
    main --- |read/reset| Config
    editor --- |r/w content| Web
    run --> |delegate| Web
    run --- |interact with| Plugins
    run --- |compare| Entities
    Web -.- |r/w| cookies
    Web -.- |r/w| headers
    Web -.- |r/w| sessions
    Web -.- |r/w| content
    cookies -.- ws["web sites"]
    headers -.- ws["web sites"]
    sessions -.- ws["web sites"]
    content -.- ws["web sites"]
    Web --- |delegate| CfrIO
    Web --- |manipulate| WebContext
    CfrIO -.- |r/w json| js["file system"]
    CfrIO -.- |execute| cmds["local commands"]
</div>

<p>You will immediately notice that:</p>
<ul>
<li>This is a CLI application, with some help from NCurses when editing a scenario file.</li>
<li>We try to keep all local side effects isolated in their own class.</li>
<li>Surely, most of this business must be asynchronous!</li>
</ul>
<p>Since this is a CLI application, the first thing we are going to do is try to figure out what it is the user wants us to do. That is&hellip;</p>
<h1 id="handling-command-line-arguments">Handling command line arguments</h1>
<p>The beauty of having pattern matching available is that we can quickly write some arguments handling without requiring an additional library.</p>
<p>First, we are going to have a quick look at <code>Sys.argv</code> to determine what high level operation we are trying to perform. We may wish to run a scenario, edit its json file, display our program&rsquo;s help page, etc.</p>
<p>Keeping in mind that, as in any language, <code>argv[0]</code> represents our executable itself, here is some simple routing:</p>
<div class="highlight"><pre class="chroma"><code class="language-ocaml" data-lang="ocaml"><span class="k">let</span> <span class="bp">()</span> <span class="o">=</span>
  <span class="n">switch</span> <span class="o">(</span><span class="nn">Sys</span><span class="p">.</span><span class="n">argv</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">|</span> <span class="o">[|_|]</span> <span class="o">=&gt;</span> <span class="n">display_help</span><span class="bp">()</span>
  <span class="o">|</span> <span class="o">[|_,</span> <span class="s2">&#34;test&#34;</span><span class="o">|]</span> <span class="o">=&gt;</span> <span class="n">run_test</span><span class="bp">()</span>
  <span class="o">|</span> <span class="o">[|_,</span> <span class="s2">&#34;help&#34;</span><span class="o">|]</span> <span class="o">=&gt;</span> <span class="n">display_help</span><span class="bp">()</span>
  <span class="o">|</span> <span class="o">[|_,</span> <span class="s2">&#34;sanity&#34;</span><span class="o">|]</span> <span class="o">=&gt;</span> <span class="n">display_sanity</span><span class="bp">()</span>
  <span class="o">|</span> <span class="o">[|_,</span> <span class="s2">&#34;timestamp&#34;</span><span class="o">,</span> <span class="n">ts</span><span class="o">,</span> <span class="n">te</span><span class="o">|]</span> <span class="o">=&gt;</span> <span class="n">display_timestamp</span><span class="o">(</span><span class="n">ts</span><span class="o">,</span> <span class="n">te</span><span class="o">)</span>
  <span class="o">|</span> <span class="o">[|_,</span> <span class="s2">&#34;reset&#34;</span><span class="o">|]</span> <span class="o">=&gt;</span> <span class="nn">Config</span><span class="p">.</span><span class="n">write_default_config_file</span><span class="bp">()</span>
  <span class="o">|</span> <span class="n">arguments</span> <span class="k">when</span> <span class="n">arguments</span><span class="o">[</span><span class="n">1</span><span class="o">]</span> <span class="o">==</span> <span class="s2">&#34;run&#34;</span> <span class="o">=&gt;</span> 
  <span class="o">...</span>
  <span class="o">|</span> <span class="o">[|_,</span> <span class="s2">&#34;modified&#34;</span><span class="o">|]</span> <span class="o">=&gt;</span> <span class="n">display_modifications</span><span class="bp">()</span>
  <span class="o">|</span> <span class="o">[|_,</span> <span class="s2">&#34;edit&#34;</span><span class="o">,</span> <span class="n">fn</span><span class="o">|]</span> <span class="o">=&gt;</span> <span class="nn">Editor</span><span class="p">.</span><span class="n">edit_source</span><span class="o">(</span><span class="n">fn</span><span class="o">)</span>
  <span class="o">|</span> <span class="o">_</span> <span class="o">=&gt;</span> <span class="n">display_help</span><span class="bp">()</span>
  <span class="o">};</span>
</code></pre></div><p>If the user, for instance, types <code>./reasonable-fidelity timestamp</code> and omits both timestamp parameters, we will default to displaying the help page.</p>

<div class="notices " >In ReasonML, arrays are denoted by <code>[| |]</code> while lists use <code>[ ]</code></div>

<p>Our most interesting match is the <code>run</code> argument, which was purposefuly elided here. What our program does is check for pre-requisites, take the relevant remaining arguments and passes them to a function that will then match these arguments to build an array of valid requests:</p>
<div class="highlight"><pre class="chroma"><code class="language-ocaml" data-lang="ocaml"><span class="k">let</span> <span class="k">rec</span> <span class="n">process_args</span> <span class="o">=</span> <span class="o">(</span><span class="n">args</span><span class="o">,</span> <span class="n">ret</span><span class="o">)</span> <span class="o">=&gt;</span>
  <span class="n">switch</span> <span class="o">(</span><span class="n">args</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">=&gt;</span> <span class="n">ret</span>
  <span class="o">|</span> <span class="o">[</span><span class="n">head</span><span class="o">,</span> <span class="o">...</span><span class="n">tail</span><span class="o">]</span> <span class="o">=&gt;</span>
    <span class="n">switch</span> <span class="o">(</span><span class="n">head</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">|</span> <span class="s2">&#34;--csv&#34;</span> <span class="o">=&gt;</span> <span class="nn">ArgSet</span><span class="p">.</span><span class="n">add</span><span class="o">(</span><span class="nc">Csv</span><span class="o">,</span> <span class="n">process_args</span><span class="o">(</span><span class="n">tail</span><span class="o">,</span> <span class="n">ret</span><span class="o">))</span>
    <span class="o">|</span> <span class="s2">&#34;--forcelogin&#34;</span> <span class="o">=&gt;</span> <span class="nn">ArgSet</span><span class="p">.</span><span class="n">add</span><span class="o">(</span><span class="nc">ForceLogin</span><span class="o">,</span> <span class="n">process_args</span><span class="o">(</span><span class="n">tail</span><span class="o">,</span> <span class="n">ret</span><span class="o">))</span>
    <span class="o">|</span> <span class="s2">&#34;--source&#34;</span> <span class="o">=&gt;</span>
      <span class="n">switch</span> <span class="o">(</span><span class="n">tail</span><span class="o">)</span> <span class="o">{</span>
      <span class="o">|</span> <span class="bp">[]</span> <span class="o">=&gt;</span> <span class="k">raise</span><span class="o">(</span><span class="nc">MissingArgument</span><span class="o">(</span><span class="s2">&#34;--source&#34;</span><span class="o">))</span>
      <span class="o">|</span> <span class="o">[</span><span class="n">arg1</span><span class="o">,</span> <span class="o">...</span><span class="n">tail</span><span class="o">]</span> <span class="o">=&gt;</span>
        <span class="nn">ArgSet</span><span class="p">.</span><span class="n">add</span><span class="o">(</span><span class="nc">Source_file</span><span class="o">(</span><span class="n">arg1</span><span class="o">),</span> <span class="n">process_args</span><span class="o">(</span><span class="n">tail</span><span class="o">,</span> <span class="n">ret</span><span class="o">))</span>
      <span class="o">}</span>
    <span class="o">|</span> <span class="s2">&#34;--config&#34;</span> <span class="o">=&gt;</span>
      <span class="n">switch</span> <span class="o">(</span><span class="n">tail</span><span class="o">)</span> <span class="o">{</span>
      <span class="o">|</span> <span class="bp">[]</span> <span class="o">=&gt;</span> <span class="k">raise</span><span class="o">(</span><span class="nc">MissingArgument</span><span class="o">(</span><span class="s2">&#34;--config&#34;</span><span class="o">))</span>
      <span class="o">|</span> <span class="o">[</span><span class="n">arg1</span><span class="o">,</span> <span class="o">...</span><span class="n">tail</span><span class="o">]</span> <span class="o">=&gt;</span>
        <span class="nn">ArgSet</span><span class="p">.</span><span class="n">add</span><span class="o">(</span><span class="nc">Config_dir</span><span class="o">(</span><span class="n">arg1</span><span class="o">),</span> <span class="n">process_args</span><span class="o">(</span><span class="n">tail</span><span class="o">,</span> <span class="n">ret</span><span class="o">))</span>
      <span class="o">}</span>
    <span class="o">|</span> <span class="n">arg_</span> <span class="o">=&gt;</span> <span class="k">raise</span><span class="o">(</span><span class="nc">InvalidArgument</span><span class="o">(</span><span class="n">arg_</span><span class="o">))</span>
    <span class="o">}</span>
  <span class="o">};</span>
</code></pre></div><p>These valid requests were declared as a <a href="https://reasonml.github.io/docs/en/variant">variant type</a>:</p>
<div class="highlight"><pre class="chroma"><code class="language-ocaml" data-lang="ocaml"><span class="k">type</span> <span class="n">cmdlineargs</span> <span class="o">=</span>
  <span class="o">|</span> <span class="nc">Source_file</span><span class="o">(</span><span class="kt">string</span><span class="o">)</span>
  <span class="o">|</span> <span class="nc">Config_dir</span><span class="o">(</span><span class="kt">string</span><span class="o">)</span>
  <span class="o">|</span> <span class="nc">ForceLogin</span>
  <span class="o">|</span> <span class="nc">Csv</span><span class="o">;</span>
</code></pre></div><p>Now that we have a normalized array of requests, we can process it:</p>
<div class="highlight"><pre class="chroma"><code class="language-ocaml" data-lang="ocaml"><span class="k">let</span> <span class="n">arg_use_csv</span> <span class="o">=</span> <span class="n">ref</span><span class="o">(</span><span class="bp">false</span><span class="o">);</span>
<span class="k">let</span> <span class="n">arg_no_login</span> <span class="o">=</span> <span class="n">ref</span><span class="o">(</span><span class="bp">true</span><span class="o">);</span>
<span class="k">let</span> <span class="n">arg_source_file</span> <span class="o">=</span> <span class="n">ref</span><span class="o">(</span><span class="s2">&#34;example.har&#34;</span><span class="o">);</span>
<span class="k">let</span> <span class="n">arg_dir_path</span> <span class="o">=</span> <span class="n">ref</span><span class="o">(</span><span class="s2">&#34;config&#34;</span><span class="o">);</span>
<span class="nn">ArgSet</span><span class="p">.</span><span class="n">iter</span><span class="o">(</span>
    <span class="n">k</span> <span class="o">=&gt;</span>
    <span class="n">switch</span> <span class="o">(</span><span class="n">k</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">|</span> <span class="nc">Csv</span> <span class="o">=&gt;</span> <span class="n">arg_use_csv</span> <span class="o">:=</span> <span class="bp">true</span>
    <span class="o">|</span> <span class="nc">ForceLogin</span> <span class="o">=&gt;</span> <span class="n">arg_no_login</span> <span class="o">:=</span> <span class="bp">false</span>
    <span class="o">|</span> <span class="nc">Source_file</span><span class="o">(</span><span class="n">file_name</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="n">arg_source_file</span> <span class="o">:=</span> <span class="n">file_name</span>
    <span class="o">|</span> <span class="nc">Config_dir</span><span class="o">(</span><span class="n">dir_path</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="n">arg_dir_path</span> <span class="o">:=</span> <span class="n">dir_path</span>
    <span class="o">},</span>
    <span class="n">args</span><span class="o">,</span>
<span class="o">);</span>
</code></pre></div><p>Using mutability, we will set some variables to default sane values, then update them with our array&rsquo;s content.</p>

<div class="notices " >In ReasonML, mutable variables can be declared using <code>ref(value)</code> and that referenced value can be updated using the <code>:=</code> operator.</div>

<p><strong>But, what is ArgSet?</strong></p>
<p>The missing piece: ReasonML lets you create modules based on other modules, to implement your own behaviors. In this example, we are talking about a very light implementation:</p>
<div class="highlight"><pre class="chroma"><code class="language-ocaml" data-lang="ocaml"><span class="k">module</span> <span class="nc">ArgSet</span> <span class="o">=</span>
  <span class="nn">Set</span><span class="p">.</span><span class="nc">Make</span><span class="o">({</span>
    <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cmdlineargs</span><span class="o">;</span>
    <span class="k">let</span> <span class="n">compare</span> <span class="o">=</span> <span class="nn">Pervasives</span><span class="p">.</span><span class="n">compare</span><span class="o">;</span>
  <span class="o">});</span>
</code></pre></div><p>We are creating a new module, meant to store requests in a set. This set is declared to be of a type <code>cmdlineargs</code> (see above) and its components can be compared using the default <code>Pervasives</code> module&rsquo;s comparison method. If you are not yet familiar with this module, please <a href="https://reasonml.github.io/api/Pervasives.html">bookmark this page</a> as it provides basic operations over ReasonML&rsquo;s built-in types.</p>
<p>As you write more ReasonML, you will see lots of references to <code>type t</code> as an object&rsquo;s type. This convention is used for clarity. For instance, it could be used when <a href="https://reasonml.github.io/docs/en/destructuring">destructuring</a> objects to write concise matching.</p>
<p>Finally, we use a couple exceptions to denote incorrect arguments:</p>
<div class="highlight"><pre class="chroma"><code class="language-ocaml" data-lang="ocaml"><span class="k">exception</span> <span class="nc">MissingArgument</span><span class="o">(</span><span class="kt">string</span><span class="o">);</span>
<span class="k">exception</span> <span class="nc">InvalidArgument</span><span class="o">(</span><span class="kt">string</span><span class="o">);</span>
</code></pre></div><p>Yes, ReasonML has exceptions support. No, you should not use them in idiomatic code. Here, I am using exceptions because I wish to bail out of the program itself. If it was in the middle of, say, processing files in a fairly long loop, returning an <code>option</code> object would allow the program to treat this error code as any expected condition.
This is not a new pattern, but it is worth noticing its adoption in &ldquo;modern&rdquo; languages: the authors of the Rust language decided not to support exceptions and instead always provide error codes. This forces the developer to immediately think about how to handle these errors, as opposed to passing the buck further up the execution stack.</p>
                        </div>
                        <aside class="lg:block tableOfContentContainer border-indigo-200" id="tableOfContentContainer">
                        <h3>Contents</h3>
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#handling-command-line-arguments">Handling command line arguments</a></li>
  </ul>
</nav>
                        </aside>
                    </main>
                
              </section>

              
              <script>talkyardServerUrl='https:\/\/comments-for-nexus-zteo-com.talkyard.net';</script>
              <script async defer src="https://c1.ty-cdn.net/-/talkyard-comments.min.js"></script>
              
              <div class="talkyard-comments" data-discussion-id="" style="margin-top: 45px;">
                  <noscript>Please enable Javascript to view comments.</noscript>
                  <p style="margin-top: 25px; opacity: 0.9; font-size: 96%">Comments powered by
                  <a href="https://www.talkyard.io">Talkyard</a>.</p>
              </div>
              

              <footer class="post-footer">
                  <div class="post-tags">
            
            
                <a href="http://zteo.com/tags/reason">reason</a>
            
                <a href="http://zteo.com/tags/functional">functional</a>
            
            
                  </div>
                
              </footer>

            
                <aside class="post-comments">
    
    
    
</aside>

            
            </div>

            <nav class="post-nav">
                
                    <a class="post-nav-item post-nav-next" href="http://zteo.com/posts/reason-native-app-part-5/">
                        <section class="post-nav-teaser">
                            <span class="post-nav-icon"><i class="fa fa-chevron-left"></i></span>
                            <span class="post-nav-info">
                                <h4 class="post-nav-title">Creating a ReasonML Native App: Configuration Files</h4>
                            </span>
                        </section>
                    </a>
                
                
                    <a class="post-nav-item post-nav-prev" href="http://zteo.com/posts/reason-native-app-part-3/">
                        <section class="post-nav-teaser">
                            <span class="post-nav-icon"><i class="fa fa-chevron-right"></i></span>
                            <span class="post-nav-info">
                                <h4 class="post-nav-title">Creating a ReasonML Native App: Building and Running</h4>
                            </span>
                        </section>
                    </a>
                
                <div class="clear"></div>
            </nav>

        </div>
    </article>
</main>
<script>
window.addEventListener('DOMContentLoaded', () => {
    const observerForTableOfContentActiveState = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            const id = entry.target.getAttribute('id');

            if (entry.intersectionRatio > 0) {
                clearActiveStatesInTableOfContents();
                document.querySelector(`aside nav li a[href="#${id}"]`).parentElement.classList.add('active');
            }
        });
    });

    document.querySelectorAll('h1[id],h2[id],h3[id],h4[id]').forEach((section) => {
        observerForTableOfContentActiveState.observe(section);
    });
});

function clearActiveStatesInTableOfContents() {
    document.querySelectorAll('aside nav li').forEach((section) => {
        section.classList.remove('active');
    });
}
</script>

                <div id="body-class" style="display: none;"></div>
                <footer id="footer">
                    <section class="credits">
                        <span class="credits-license"><i class="fa fa-copyright"></i>2020 The Nexus
                    </span>
                    </section>
                </footer>
                

                

                
                <div class="overlay"></div>
            </div>
        </section>

<video autoplay loop id="video-background" muted plays-inline>
<source src="http://zteo.com/images/hd0198.mp4" type="video/mp4">
</video>

<script src="/mermaid/mermaid.js?1604042317"></script>
<script async src="http://zteo.com//js/main.js"></script>
<script async src="http://zteo.com//js/basicLightbox.min.js"></script>

<script>


function defer(method) {
    if (window.jQuery) {
        method();
    } else {
        setTimeout(function() { defer(method) }, 50);
    }
}
defer(function() {
    jQuery.fn.doubleTapToGo = function( params ) {
        if( !( 'ontouchstart' in window ) &&
            !navigator.msMaxTouchPoints &&
            !navigator.userAgent.toLowerCase().match( /windows phone os 7/i ) ) return false;

        this.each( function()
        {
            var curItem = false;

            jQuery( this ).on( 'click', function( e )
            {
                var item = jQuery( this );
                if( item[ 0 ] != curItem[ 0 ] )
                {
                    e.preventDefault();
                    curItem = item;
                }
            });

            jQuery( document ).on( 'click touchstart MSPointerDown', function( e )
            {
                var resetItem = true,
                    parents	  = jQuery( e.target ).parents();

                for( var i = 0; i < parents.length; i++ )
                    if( parents[ i ] == curItem[ 0 ] )
                        resetItem = false;

                if( resetItem )
                    curItem = false;
            });
        });
        return this;
    };
    jQuery( '#nav li:has(ul)' ).doubleTapToGo();
});
</script>

<script>
    mermaid.initialize({ startOnLoad: true });
</script>




  <noscript><link rel="stylesheet" href="http://zteo.com//css/main.css"></noscript>
</body>
</html>

