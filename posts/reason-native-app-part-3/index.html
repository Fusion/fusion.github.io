
<!DOCTYPE html>
<html lang="en-us">

<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta property="og:title" content=" Creating a ReasonML Native App: Building and Running &middot;  The Nexus" />
    <meta property="og:site_name" content="The Nexus" />
    <meta property="og:url" content="http://zteo.com/posts/reason-native-app-part-3/" />

    
    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content="2018-09-08T13:33:01-03:00" />
    <meta property="og:article:tag" content="reason" />
    <meta property="og:article:tag" content="functional" />
    

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta name="twitter:title" content="Creating a ReasonML Native App: Building and Running" />
    
    <meta name="twitter:description" content="This is by far the most boring piece of this whole endeavor.
Unfortunately, as we accumulate years of experience, old habits accrete on the programmer and tools such as Make become an integral part of our fossilized identity. You will have to forgive me for my use of Makefiles!" />
    <meta name="twitter:url" content="http://zteo.com/posts/reason-native-app-part-3/" />
    

    <title> Creating a ReasonML Native App: Building and Running &middot;  The Nexus</title>

    <link rel="preload" href="http://zteo.com//css/fontawesome-all.min.css" as="style" />
    <link rel="preload" href="http://zteo.com//js/main.js" as="script" />
    <link rel="preload" href="http://zteo.com//css/main.css" as="style" />
    
    <link href="/mermaid/mermaid.cfr.css?1588393676" type="text/css" rel="stylesheet" />
    
    
    <link rel="preload" href="http://zteo.com//css/cfr.css" as="style" />
    <link rel="stylesheet" href="http://zteo.com//css/main.css">
    <link rel="stylesheet" href="http://zteo.com//css/pure-min.css">
    <link rel="preload" href="http://zteo.com//js/basicLightbox.min.js" as="script" />
    <link rel="stylesheet" href="http://zteo.com//css/basicLightbox.min.css">
    <link rel="stylesheet" href="http://zteo.com//css/fontawesome-all.min.css" />
    <link rel="stylesheet" href="http://zteo.com//css/cfr.css">
    <link rel="stylesheet" href="http://zteo.com//css/syntax.css">
    
    
    


    
    <meta name="description" content="" />
    

    
    <meta name="p:domain_verify" content=""/>
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    

    
    <link href="http://zteo.com/index.xml" rel="alternate" type="application/rss+xml" title="The Nexus" />
    

    
    <link rel="canonical" href="http://zteo.com/posts/reason-native-app-part-3/" />

    
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "http:\/\/zteo.com\/posts\/reason-native-app-part-3\/"
        },
        "headline": "Creating a ReasonML Native App: Building and Running",
        "description": "",
        "author": {
            "@type": "Person",
            "name": " ",
            "url": "http://profiles.google.com/?rel=author",
            "image": {
              "@type": "ImageObject",
              "url": "https:",
              "height": 80,
              "width": 80
            }
        },
        "publisher": {
          "@type": "Organization",
          "@id": "http:\/\/zteo.com\/",
          "name": "The Nexus",
          "url": "http:\/\/zteo.com\/",
          "logo": {
            "@type": "ImageObject",
            "url": "https:",
            "height": 80,
            "width": 80
          }
        },
        
        "image": {
          "@type": "ImageObject",
          "url": "",
          "height": 80,
          "width": 80
        },
        "datePublished": "2018-09-08",
        "dateModified": "2018-09-08",
        "wordCount":  334 ,
        "keywords": "[\"reason\",\"functional\"]" 
    }
    </script>
    

    
    <script type="text/javascript">
        
        
    </script>
    

    <script type="text/javascript">
        var config = {
            baseUrl: "http:\/\/zteo.com\/"
        };
    </script>

</head>
<body class="home-template">
<div id="loader-wrapper">
    <div id="loader"></div>
</div>
<section id="wrapper" style="display: none;">
    <div id="ajax-container">
        <nav id="nav" class="nav">
            <div class="nav-logo">
                <a href="http://zteo.com/">
                    
                    The Nexus
                    
                </a>
            </div>

            <nav id="nav2" role="navigation">
                <a href="#nav" title="Show navigation">Show navigation</a>
                <a href="#" title="Hide navigation">Hide navigation</a>
                <ul class="clearfix">
                    <li><a href="http://zteo.com/">BLOG</a></li>
                    <li>
                        <a href="http://zteo.com/meta/about" aria-haspopup="true"><span>ABOUT</span></a>
                        <ul>
                            <li><a href="http://zteo.com/meta/egosurfing">Ego Surfing</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="http://zteo.com/projects/projects-list" aria-haspopup="true"><span>PROJECTS</span></a>
                        <ul>
                            <li><a href="http://zteo.com/projects/n2">n2</a></li>
                            <li><a href="http://zteo.com/projects/s2ajax">S2ajax</a></li>
                            <li><a href="http://zteo.com/projects/condo">Condo</a></li>
                            <li><a href="http://zteo.com/projects/ezedit">ezEdit</a></li>
                            <li><a href="http://zteo.com/projects/freeblog">FreeBlog - Air</a></li>
                            <li><a href="http://zteo.com/projects/tooredo-alpha">Tooredo Alpha</a></li>
                            <li><a href="http://zteo.com/projects/tools">Tools</a></li>
                            <li><a href="http://zteo.com/projects/journler-again">Journlr, Again!</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>


            <div id="main-menu" class="nav-menu">
                
                
                <a id="search-button" onclick="$('#search-form').toggle();" title="Search"><i class="fa fa-search"></i></a>
                <form id="search-form" method="get" role="search" action="https://google.com/search">
                    <input type="hidden" name="as_sitesearch" value="http://zteo.com/">
                    <input type="text" name="q" maxlength="255" placeholder="Search..." class="form-control">
                    <input type="submit" value="Search">
                </form>
                
                
                
                
            </div>
        </nav>


<style>
@media(min-width:1024px) {
	main {
		display: grid;
		grid-template-columns: 100% 100%;
	}
}

</style>

<main class="content" role="main">
    <article class="post post-with-bg">
        <div class="inner">

            <div id="push">

                <header class="post-header">
                
                    <span class="post-meta">
                        <span class="post-date">8 Sep 2018</span> <span class="reading-time">| <span class="estimated-reading-time">2 min.</span> (<span class="word-count">334</span> words)</span></span>
                    </span>
                <div class="clear"></div>
                
                <h1 class="post-title">Creating a ReasonML Native App: Building and Running</h1>
              </header>

              <section class="post-content">
                

                
                
                
                    <div class="noticesc">
                    This post is part of a series. Related posts:
                    <ul>
                    
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                            
                                <li><a href="http://zteo.com/posts/reason-native-app/">Creating a ReasonML Native App: What We Are Building</a></li>
                            
                        
                    
                        
                        
                            
                                <li><a href="http://zteo.com/posts/reason-native-app-part-2/">Creating a ReasonML Native App: Installing, Editing, Configuring</a></li>
                            
                        
                    
                        
                        
                    
                        
                        
                            
                                <li><a href="http://zteo.com/posts/reason-native-app-part-4/">Creating a ReasonML Native App: Command Line Arguments</a></li>
                            
                        
                    
                        
                        
                            
                                <li><a href="http://zteo.com/posts/reason-native-app-part-5/">Creating a ReasonML Native App: Configuration Files</a></li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Curses Terminal Interface</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Python Plugins</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Files I/Os</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Native Promises</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Web Requests</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Shell Commands</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Handling CSV Files</li>
                            
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Native JSON Handling</li>
                            
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                            
                                <li>Creating a ReasonML Native App: Memoizing DNS queries</li>
                            
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                        
                    
                    </ul>
                    </div>
                


                
                    <p>This is by far the most boring piece of this whole endeavor.</p>
<p>Unfortunately, as we accumulate years of experience, old habits accrete on the programmer and tools such as <code>Make</code> become an integral part of our fossilized identity. You will have to forgive me for my use of Makefiles!</p>
<p>Our Makefile will contain targets for building release binaries for MacOS and Linux as well as preparing our system for Curses bindings.</p>
<p>Our build targets are the simplest. Since I am building on MacOS, the <code>build</code> target will be run both natively and in a docker container to &ldquo;cross-compile&rdquo; a Linux version:</p>
<div class="highlight"><pre class="chroma"><code class="language-makefile" data-lang="makefile"><span class="nf">build</span><span class="o">:</span>
        jbuilder build

<span class="nf">release</span><span class="o">:</span> <span class="n">releases</span>/<span class="n">reasonable</span>-<span class="n">fidelity</span>-<span class="n">macos</span> <span class="n">releases</span>/<span class="n">reasonable</span>-<span class="n">fidelity</span>-<span class="n">linux</span>

<span class="nf">releases/reasonable-fidelity-macos</span><span class="o">:</span>
        @echo <span class="s2">&#34;Storing macos release in releases/&#34;</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        cp _build/default/src/main.exe releases/reasonable-fidelity-macos

<span class="nf">releases/reasonable-fidelity-linux</span><span class="o">:</span>
        @echo <span class="s2">&#34;Storing linux release in releases/&#34;</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        docker cp ubuntu-headless:/home/chris/reasonable-fidelity/_build/default/src/main.exe releases/reasonable-fidelity-linux
</code></pre></div><p>Our use of <a href="https://github.com/andyli/jbuilder">jbuilder</a> should be a pretty clear indicator that we are working squarely in an OCaml tooling environment.</p>
<p>Running our compiled binaries while under development is as simple as:</p>
<div class="highlight"><pre class="chroma"><code class="language-makefile" data-lang="makefile"><span class="nf">run</span><span class="o">:</span> <span class="n">build</span>
        ./_build/install/default/bin/reasonable-fidelity run

</code></pre></div><p>The remainder of the Makefile is dedicated to making sure we have working Curses bindings:</p>
<div class="highlight"><pre class="chroma"><code class="language-makefile" data-lang="makefile"><span class="nv">CURSES_PKG_NAME</span><span class="o">=</span>ocaml-curses-1.0.3.ogunden1.tar.gz

<span class="nf">prepare_curses</span><span class="o">:</span> <span class="n">prepare_tools</span> <span class="n">ocaml</span>-<span class="n">curses</span>-1.0.3 <span class="n">ocaml</span>-<span class="n">curses</span>-1.0.3/<span class="n">patched</span> <span class="n">curses_howto</span>

<span class="nf">prepare_tools</span><span class="o">:</span>
<span class="err">ifeq</span> <span class="err">(,</span><span class="k">$(</span><span class="nv">shell</span> <span class="nv">which</span> <span class="nv">curl</span><span class="k">)</span><span class="err">)</span>
<span class="err">ifeq</span> <span class="err">(,</span><span class="k">$(</span><span class="nv">shell</span> <span class="nv">which</span> <span class="nv">wget</span>2<span class="k">)</span><span class="err">)</span>
        <span class="err">@echo</span> <span class="s2">&#34;\n# Please, install curl or wget #\n&#34;</span>
        <span class="err">exit</span> <span class="err">1</span>
<span class="err">else</span>
        <span class="nf">$(eval getter </span><span class="o">:</span>= <span class="n">wget</span>)
<span class="err">endif</span>
<span class="err">else</span>
        <span class="nf">$(eval getter </span><span class="o">:</span>= <span class="n">curl</span> -<span class="n">O</span>)
<span class="err">endif</span>
<span class="err">ifeq</span> <span class="err">(,</span><span class="k">$(</span><span class="nv">shell</span> <span class="nv">which</span> <span class="nv">autoreconf</span><span class="k">)</span><span class="err">)</span>
        <span class="err">@echo</span> <span class="s2">&#34;\n# Please, install autoconf/autoreconf #\n&#34;</span>
        <span class="err">exit</span> <span class="err">1</span>
<span class="err">endif</span>
<span class="err">ifeq</span> <span class="err">(,</span><span class="k">$(</span><span class="nv">shell</span> <span class="nv">which</span> <span class="nv">make</span><span class="k">)</span><span class="err">)</span>
        <span class="err">@echo</span> <span class="s2">&#34;\n# Please, install make and build essential #\n&#34;</span>
        <span class="err">exit</span> <span class="err">1</span>
<span class="err">endif</span>

<span class="nf">ocaml-curses-1.0.3</span><span class="o">:</span>
        @echo <span class="s2">&#34;\n# Downloading curses source code file\n&#34;</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        <span class="k">$(</span>getter<span class="k">)</span> http://ocaml.phauna.org/distfiles/<span class="k">$(</span>CURSES_PKG_NAME<span class="k">)</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        tar zxvf <span class="k">$(</span>CURSES_PKG_NAME<span class="k">)</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        rm <span class="k">$(</span>CURSES_PKG_NAME<span class="k">)</span>

<span class="nf">ocaml-curses-1.0.3/patched</span><span class="o">:</span>
        @echo <span class="s2">&#34;\n# Patching curses source code file\n&#34;</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        <span class="nb">cd</span> ocaml-curses-1.0.3 <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        autoreconf <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        configure --enable-widec <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        sed -i <span class="s1">&#39;/if test -n &#34;$$TERM_H_STRING&#34;/i   TERM_H_STRING=&#34;&lt;term.h&gt;&#34;&#39;</span> configure <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        touch patched

<span class="nf">curses_howto</span><span class="o">:</span>
        @echo <span class="s2">&#34;\nIf you are using this patched curses version\n(all the patch does is lie about &#39;term.h&#39;)&#34;</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>        <span class="nb">echo</span> <span class="s2">&#34;then do not forget to:\n\n    cd ocaml-curses-1.0.3\n    make all opt install\n&#34;</span>
</code></pre></div>
                
              </section>

              
              <script>talkyardServerUrl='https:\/\/comments-for-nexus-zteo-com.talkyard.net';</script>
              <script async defer src="https://c1.ty-cdn.net/-/talkyard-comments.min.js"></script>
              
              <div class="talkyard-comments" data-discussion-id="" style="margin-top: 45px;">
                  <noscript>Please enable Javascript to view comments.</noscript>
                  <p style="margin-top: 25px; opacity: 0.9; font-size: 96%">Comments powered by
                  <a href="https://www.talkyard.io">Talkyard</a>.</p>
              </div>
              

              <footer class="post-footer">
                  <div class="post-tags">
            
            
                <a href="http://zteo.com/tags/reason">reason</a>
            
                <a href="http://zteo.com/tags/functional">functional</a>
            
            
                  </div>
                
              </footer>

            
                <aside class="post-comments">
    
    
    
</aside>

            
            </div>

            <nav class="post-nav">
                
                    <a class="post-nav-item post-nav-next" href="http://zteo.com/posts/reason-native-app-part-4/">
                        <section class="post-nav-teaser">
                            <span class="post-nav-icon"><i class="fa fa-chevron-left"></i></span>
                            <span class="post-nav-info">
                                <h4 class="post-nav-title">Creating a ReasonML Native App: Command Line Arguments</h4>
                            </span>
                        </section>
                    </a>
                
                
                    <a class="post-nav-item post-nav-prev" href="http://zteo.com/posts/reason-native-app-part-2/">
                        <section class="post-nav-teaser">
                            <span class="post-nav-icon"><i class="fa fa-chevron-right"></i></span>
                            <span class="post-nav-info">
                                <h4 class="post-nav-title">Creating a ReasonML Native App: Installing, Editing, Configuring</h4>
                            </span>
                        </section>
                    </a>
                
                <div class="clear"></div>
            </nav>

        </div>
    </article>
</main>
<script>
window.addEventListener('DOMContentLoaded', () => {
    const observerForTableOfContentActiveState = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            const id = entry.target.getAttribute('id');

            if (entry.intersectionRatio > 0) {
                clearActiveStatesInTableOfContents();
                document.querySelector(`aside nav li a[href="#${id}"]`).parentElement.classList.add('active');
            }
        });
    });

    document.querySelectorAll('h1[id],h2[id],h3[id],h4[id]').forEach((section) => {
        observerForTableOfContentActiveState.observe(section);
    });
});

function clearActiveStatesInTableOfContents() {
    document.querySelectorAll('aside nav li').forEach((section) => {
        section.classList.remove('active');
    });
}
</script>

                <div id="body-class" style="display: none;"></div>
                <footer id="footer">
                    <section class="credits">
                        <span class="credits-license"><i class="fa fa-copyright"></i>2020 The Nexus
                    </span>
                    </section>
                </footer>
                

                

                
                <div class="overlay"></div>
            </div>
        </section>

<video autoplay loop id="video-background" muted plays-inline>
<source src="http://zteo.com/images/hd0198.mp4" type="video/mp4">
</video>

<script src="/mermaid/mermaid.js?1588393676"></script>
<script async src="http://zteo.com//js/main.js"></script>
<script async src="http://zteo.com//js/basicLightbox.min.js"></script>

<script>


function defer(method) {
    if (window.jQuery) {
        method();
    } else {
        setTimeout(function() { defer(method) }, 50);
    }
}
defer(function() {
    jQuery.fn.doubleTapToGo = function( params ) {
        if( !( 'ontouchstart' in window ) &&
            !navigator.msMaxTouchPoints &&
            !navigator.userAgent.toLowerCase().match( /windows phone os 7/i ) ) return false;

        this.each( function()
        {
            var curItem = false;

            jQuery( this ).on( 'click', function( e )
            {
                var item = jQuery( this );
                if( item[ 0 ] != curItem[ 0 ] )
                {
                    e.preventDefault();
                    curItem = item;
                }
            });

            jQuery( document ).on( 'click touchstart MSPointerDown', function( e )
            {
                var resetItem = true,
                    parents	  = jQuery( e.target ).parents();

                for( var i = 0; i < parents.length; i++ )
                    if( parents[ i ] == curItem[ 0 ] )
                        resetItem = false;

                if( resetItem )
                    curItem = false;
            });
        });
        return this;
    };
    jQuery( '#nav li:has(ul)' ).doubleTapToGo();
});
</script>

<script>
    mermaid.initialize({ startOnLoad: true });
</script>




  <noscript><link rel="stylesheet" href="http://zteo.com//css/main.css"></noscript>
</body>
</html>

